# Jenkins Configuration as Code (JCasC)
# Este archivo configura Jenkins autom谩ticamente al iniciar

jenkins:
  # Configuraci贸n de seguridad
  securityRealm:
    local:
      allowsSignup: false
      users:
        - id: "${JENKINS_ADMIN_ID:-admin}"
          password: "${JENKINS_ADMIN_PASSWORD:-admin123}"
          name: "Administrator"
          description: "Jenkins Admin User"

  # Configuraci贸n de autorizaci贸n
  authorizationStrategy:
    globalMatrix:
      permissions:
        - "Overall/Administer:${JENKINS_ADMIN_ID:-admin}"
        - "Overall/Read:authenticated"

  # Configuraci贸n del sistema
  systemMessage: |
     Jenkins CI/CD Server
    Integrado con Gitea y Docker
    
    Credenciales por defecto:
    - Usuario: admin
    - Cambiar contrase帽a despu茅s del primer login

  # N煤mero de ejecutores
  numExecutors: 2
  
  # Modo de etiquetas
  mode: NORMAL

  # Configuraci贸n de seguridad adicional
  crumbIssuer:
    standard:
      excludeClientIPFromCrumb: true

# Configuraci贸n de credenciales
credentials:
  system:
    domainCredentials:
      - credentials:
          # Credencial para Gitea usando usuario/contrase帽a
          - usernamePassword:
              scope: GLOBAL
              id: "gitea-credentials"
              username: "${GITEA_USERNAME:-jenkins}"
              password: "${GITEA_PASSWORD:-jenkins123}"
              description: "Credenciales de usuario para Gitea"

# Configuraci贸n de herramientas
tool:
  git:
    installations:
      - name: "Default"
        home: "git"

# Configuraci贸n de notificaciones (opcional)
unclassified:
  location:
    url: "http://localhost:8081/"
    adminAddress: "admin@example.com"
  
  # Configuraci贸n de servidores Gitea
  giteaServers:
    servers:
      - displayName: "Gitea Server"
        # NOTA: Dentro de la red Docker, usar el nombre del SERVICIO (gitea), no el nombre del contenedor
        serverUrl: "http://gitea:3000"
        manageHooks: true
        # Credenciales: usar usuario/contrase帽a
        credentialsId: "gitea-credentials"

  # Timezone
  timestamper:
    allPipelines: true
    elapsedTimeFormat: "'<b>'HH:mm:ss.S'</b> '"
    systemTimeFormat: "'<b>'HH:mm:ss'</b> '"
